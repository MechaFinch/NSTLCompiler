
-- benchmark
-- Runs some processing intensive programs
--
-- Performance History
--	total			mandel			badapple
--	1,042,397,939									original
--    961,684,560	 387,508,236	 574,176,324	ISA update
--    895,929,275	 334,554,024	 561,375,251	Use wide compares
--    908,169,006    346,793,755     561,375,251	Pre-assembler change
--    893,023,672    331,648,166     561,375,506	Post-assembler change
--

library _badappleplayer;
library _mandel;
library _util;

external function _badappleplayer.main of none;
external function _mandel.mandel of none;

variable hcf is ptr gets -1;

variable iret is u8 gets 0xD7;
variable nmi is u32 pointer gets 4;

function main of none begin
	at nmi gets to iret;

	-- run benchmarks
	call _mandel.mandel with none;
	call _util.halt with none;
	
	call _badappleplayer.main with none;
	
	-- halt and catch fire
	call hcf with none;
end function
