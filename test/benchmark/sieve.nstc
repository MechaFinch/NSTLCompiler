
--
-- Benchmarking: Sieve of Eratosthenes as done in Byte Sieve
--

lib _gutil from "simvideo/gutil";

fn sieve() {
	var iters: u8 = 1;
	var screen: &u8 = 0xF002_0000;
	var size: u32 = (320 * 240) - 1;
	
	_gutil.clear_screen(0x00);

	for(iter: u8 = 1; iter <= iters; iter += 1) [
		var t: u8 = (((iter as u16) * 255) / (iters as u16)) as u8;
		
		for(i: u32 = 0; i <= size; i += 1) {
			screen[i] = t;
		}
		
		for(i: u32 = 0; i <= size; i += 1) {
			if(screen[i] != 0) {
				var prime: u32 = i + i + 3;
				var k: u32 = i + prime;
				
				while(k <= size) {
					screen[k] = 0x00;
					k += prime;
				}
			}
		}
	}
}
